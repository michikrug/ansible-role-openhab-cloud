#jinja2: lstrip_blocks: "True"
[Unit]
Description=openHAB Cloud ({{ openhab_cloud_identifier }})
{% for service in openhab_cloud_systemd_required_services_list %}
Requires={{ service }}
After={{ service }}
{% endfor %}
{% for service in openhab_cloud_systemd_wanted_services_list %}
Wants={{ service }}
{% endfor %}
DefaultDependencies=no

[Service]
Type=simple
WorkingDirectory={{ openhab_cloud_source_path }}/deployment/docker-compose
Environment="HOME={{ devture_systemd_docker_base_systemd_unit_home_path }}"

ExecStartPre={{ devture_systemd_docker_base_host_command_docker }} compose pull --quiet --parallel --ignore-buildable

ExecStart={{ devture_systemd_docker_base_host_command_docker }} compose up --remove-orphans
ExecStop={{ devture_systemd_docker_base_host_command_docker }} compose down --remove-orphans

ExecReload={{ devture_systemd_docker_base_host_command_docker }} compose pull --quiet --parallel --ignore-buildable
ExecReload={{ devture_systemd_docker_base_host_command_docker }} compose up -d

TimeoutStartSec=0

Restart=always
RestartSec=30
SyslogIdentifier={{ openhab_cloud_identifier }}

[Install]
WantedBy=multi-user.target
